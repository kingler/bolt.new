---
component: lib_components
description: Contains utility functions and libraries for the application
main-technologies:
  - TypeScript
  - Web Crypto API
  - Fetch API
conventions:
  - Use memoization for performance optimization
  - Use Web Crypto API for cryptographic operations
  - Use Fetch API for network requests
---

# Library Components

This directory contains utility functions and libraries for the application. These components provide essential functionalities such as cryptographic operations and network requests, enabling secure and efficient data handling.

## Structure

- `crypto.ts`: Utility functions for cryptographic operations
- `fetch.ts`: Utility functions for making network requests

## Key Responsibilities

1. Providing cryptographic operations for data encryption and decryption
2. Facilitating secure and efficient network requests
3. Ensuring performance optimization through memoization
4. Managing state and interactions within utility functions

## Development Guidelines

- Use memoization (React.memo) for performance optimization
- Utilize Web Crypto API for cryptographic operations
- Implement network requests using Fetch API
- Use type hints and docstrings for better code readability

## Component Implementation

### crypto.ts

This file contains utility functions for cryptographic operations. It provides functions for data encryption and decryption using the Web Crypto API. The functions include generating cryptographic keys, encoding and decoding data, and handling initialization vectors (IVs) for encryption.

### fetch.ts

This file contains utility functions for making network requests. It provides a wrapper around the Fetch API to handle network requests in both development and production environments. The functions include handling HTTPS agents for secure requests and managing request initialization options.

## Usage Example

### crypto.ts

This file contains utility functions for cryptographic operations. It provides functions for data encryption and decryption using the Web Crypto API. The functions include generating cryptographic keys, encoding and decoding data, and handling initialization vectors (IVs) for encryption.

#### Purpose
The purpose of this section is to offer secure cryptographic operations for the application, ensuring data confidentiality and integrity during storage and transmission.

#### How It Works

1. **Text Encoding and Decoding**: 
   - The `TextEncoder` and `TextDecoder` are used to convert strings to and from byte arrays, which are necessary for cryptographic operations.

2. **Initialization Vector (IV) Generation**:
   - A random initialization vector (IV) of 16 bytes is generated using `crypto.getRandomValues`. This IV is crucial for the AES-CBC encryption algorithm to ensure that the same plaintext encrypted multiple times will yield different ciphertexts.

3. **Key Generation**:
   - The `getKey` function imports a raw key string into a cryptographic key object using the Web Crypto API. This key is used for both encryption and decryption.

4. **Encryption**:
   - The `encrypt` function takes a key and data string, generates an IV, and encrypts the data using the AES-CBC algorithm. The resulting ciphertext and IV are combined into a single byte array and encoded into a base64 string for easy storage or transmission.

5. **Decryption**:
   - The `decrypt` function takes a key and a base64-encoded payload, decodes it into a byte array, extracts the IV and ciphertext, and decrypts the data using the AES-CBC algorithm. The resulting plaintext is then decoded back into a string.

6. **Base64 Encoding and Decoding**:
   - The `encodeBase64` and `decodeBase64` functions handle the conversion between byte arrays and base64 strings, which are used to represent binary data in a text format.

By following these steps, the `crypto.ts` file ensures that data can be securely encrypted and decrypted, maintaining the confidentiality and integrity of the application's data.
