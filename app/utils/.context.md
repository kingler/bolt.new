---
component: utils
description: Contains utility functions and constants used throughout the application
main-technologies:
  - TypeScript
  - JavaScript
conventions:
  - Use TypeScript for type safety and code clarity
  - Implement proper error handling and logging mechanisms
  - Use memoization and debouncing for performance optimization
---

# Utility Functions and Constants

This directory contains various utility functions and constants used throughout the application. These utilities provide common functionalities that can be reused across different parts of the application, ensuring consistency and reducing code duplication.

## Structure

- `buffer.ts`: Utility for buffering events
- `classNames.ts`: Utility for conditionally joining class names
- `constants.ts`: Defines constants used throughout the application
- `debounce.ts`: Utility for debouncing function calls
- `diff.ts`: Utility for computing file differences
- `easings.ts`: Defines easing functions for animations
- `logger.ts`: Utility for logging messages with different debug levels
- `markdown.ts`: Utilities for processing and sanitizing markdown content
- `mobile.ts`: Utility for detecting mobile devices
- `promises.ts`: Utility for creating promises with resolvers
- `react.ts`: Utility for memoizing React components
- `shell.ts`: Utility for managing shell processes
- `stripIndent.ts`: Utility for stripping indentation from strings
- `terminal.ts`: Utility for handling terminal escape codes
- `unreachable.ts`: Utility for handling unreachable code paths

## Key Responsibilities

1. Providing common utility functions for various tasks
2. Ensuring consistency and reducing code duplication
3. Enhancing performance through memoization and debouncing
4. Managing constants and configuration values
5. Handling logging and error reporting

## Development Guidelines

- Use TypeScript for type safety and code clarity
- Implement proper error handling and logging mechanisms
- Utilize memoization and debouncing for performance optimization
- Use type hints and docstrings for better code readability

## Utility Implementation

### buffer.ts

This utility provides a function `bufferWatchEvents` for buffering events over a specified time interval. It collects events and processes them in batches, ensuring that events are processed in order.

**How it works:**
1. The function initializes a timeout and an array to store events.
2. It defines a `scheduleBufferTick` function to process the events after the specified time interval.
3. The returned function collects events and schedules the buffer tick if not already scheduled.

### classNames.ts

This utility provides a function `classNames` for conditionally joining class names together. It takes a series of class names or objects and returns a single string of class names.

**How it works:**
1. The function iterates over the arguments and parses each value.
2. It appends the parsed class names to a single string.
3. The final string of class names is returned.

### constants.ts

This file defines constants used throughout the application. These constants provide configuration values and identifiers for various parts of the application.

**Defined constants:**
- `WORK_DIR_NAME`: Name of the working directory
- `WORK_DIR`: Path to the working directory
- `MODIFICATIONS_TAG_NAME`: Tag name for file modifications

### debounce.ts

This utility provides a function `debounce` for debouncing function calls. It ensures that the function is called only after a specified delay, preventing excessive calls.

**How it works:**
1. The function initializes a timer.
2. It returns a debounced function that clears the timer and sets a new one.
3. The debounced function calls the original function after the delay.

### diff.ts

This utility provides functions for computing file differences and converting them to HTML. It uses the `diff` library to create unified diffs.

**Functions:**
- `computeFileModifications`: Computes file modifications based on original and modified files.
- `diffFiles`: Computes a unified diff between two file contents.
- `fileModificationsToHTML`: Converts file modifications to HTML format.

### easings.ts

This file defines easing functions for animations. It uses the `framer-motion` library to create cubic bezier easing functions.

**Defined easing functions:**
- `cubicEasingFn`: A cubic bezier easing function with specific control points.

### logger.ts

This utility provides a logging mechanism with different debug levels. It allows logging messages with different levels of severity and supports color-coded output.

**How it works:**
1. The `logger` object defines functions for each debug level.
2. The `log` function handles the actual logging, formatting the messages and applying styles.
3. The `createScopedLogger` function creates a logger with a specific scope.

### markdown.ts

This utility provides functions for processing and sanitizing markdown content. It leverages various plugins to ensure that the markdown is parsed, sanitized, and transformed correctly.

**Purpose:**
The purpose of this file is to handle markdown processing, including parsing, sanitizing, and transforming markdown content to ensure safe and consistent output.

**How it works:**
1. **Allowed HTML Elements:**
   - Defines a list of allowed HTML elements that can be used in the markdown content.
   
2. **Sanitization Options:**
   - Configures the `rehypeSanitize` options to specify which HTML elements and attributes are allowed, ensuring that the content is safe and sanitized.

3. **remarkPlugins Function:**
   - This function returns a list of remark plugins to be used for processing markdown.
   - If `limitedMarkdown` is true, it includes a custom `limitedMarkdownPlugin` to restrict the markdown content.

4. **rehypePlugins Function:**
   - This function returns a list of rehype plugins to be used for processing HTML.
   - If `html` is true, it includes `rehypeRaw` and `rehypeSanitize` plugins to parse and sanitize the HTML content.

5. **limitedMarkdownPlugin:**
   - A custom plugin that restricts the types of nodes allowed in the markdown content.
   - It visits each node in the markdown tree and replaces disallowed nodes with plain text.

**Functions:**
- `remarkPlugins(limitedMarkdown: boolean)`: Returns a list of remark plugins based on the `limitedMarkdown` flag.
- `rehypePlugins(html: boolean)`: Returns a list of rehype plugins based on the `html` flag.
- `allowedHTMLElements`: An array of allowed HTML elements for sanitization.
- `rehypeSanitizeOptions`: Configuration options for the `rehypeSanitize` plugin.
- `limitedMarkdownPlugin`: A custom plugin to restrict markdown content.


